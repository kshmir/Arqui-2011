cd bin

nasm -f aout ../src/libasm.asm -o libasm.o
nasm -f aout ../src/kstart.asm -o kstart.o
nasm -f aout ../src/loader.asm -o kstart.o

if [[ $(uname) =~ "Darwin" ]]; then
    export GCC_DARWIN=/Users/cristian/Downloads/bin/i386-aout-linux-gcc
    export LD_DARWIN=/Users/cristian/Downloads/bin/i386-aout-linux-ld
    $GCC_DARWIN -fno-builtin -o kernel.o -c ../src/kernel.c 
    $GCC_DARWIN -fno-builtin -o kernel.o -c ../src/kernel.c 
    $GCC_DARWIN -fno-builtin -o libc.o -c ../src/libc.c  
    $GCC_DARWIN -fno-builtin -o keyboard.o -c ../src/keyboard.c  
    $LD_DARWIN -T ../src/link.ld -o kernel.bin kernel.o kstart.o libc.o libasm.o keyboard.o
else
    gcc -c ../src/kernel.c -o kernel.o -fno-builtin
    gcc -c ../src/libc.c  -o libc.o -fno-builtin
    gcc -c ../src/keyboard.c  -o keyboard.o -fno-builtin
    gcc -c ../src/IO.c  -o IO.o -fno-builtin
    ld -T ../src/link.ld -o kernel.bin kernel.o kstart.o libc.o libasm.o keyboard.o IO.o
fi


echo "Compila end"
